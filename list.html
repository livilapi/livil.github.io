<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <script src="top.js"></script>
</head>

<body>
    <script src="left.js"></script>

    <div class="main-content">
        <div class="header">
            <div class="container-fluid">
                <div class="header-body">
                    <div class="row align-items-end">
                        <div class="col">
                            <h6 class="header-pretitle">Admin Home</h6>
                            <h1 class="header-title">회원관리</h1>
                        </div>
                        <div class="col-auto d-none d-md-flex">
                            <a href="javascript:logout();" class="btn btn-primary">로그아웃</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="container-fluid">
            <div class="card" data-toggle="lists">
                <div class="table-responsive">
                    <table class="table table-sm table-nowrap card-table">
                        <thead>
                            <tr>
                                <th style="text-align: center;">코인</th>
                                <th style="text-align: center;">가격(PAX)</th>
                                <th style="text-align: center;">가격(CNY)</th>
                                <th style="text-align: center;">가격(USD)</th>
                                <th style="text-align: center;">가격(KRW)</th>
                                <th style="text-align: center;">지불코인(수량)</th>
                                <th style="text-align: center;">지불코인(교환 수량)</th>
                                <th style="text-align: center;">받은코인(수량)</th>
                                <th style="text-align: center;">받은코인(교환 수량)</th>
                            </tr>
                        </thead>

                        <tbody class="list" id="t_list">
                            <tr>
                                <td class="orders-date table table-sm table-nowrap card-table" colspan="9" align="center">No Data</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="btn-group btn-group mr-2 mb-3" style="padding-left: 45%;" id="pagination-wrapper"></div>
        </div>
    </div>

    <div class="modal fade" id="modalMembers" tabindex="-1" role="dialog" aria-hidden="true"></div>
</body>

<script src="assets/libs/jquery/dist/jquery.min.js"></script>
<script src="assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="assets/libs/@shopify/draggable/lib/es5/draggable.bundle.legacy.js"></script>
<script src="assets/libs/autosize/dist/autosize.min.js"></script>
<script src="assets/libs/chart.js/dist/Chart.min.js"></script>
<script src="assets/libs/dropzone/dist/min/dropzone.min.js"></script>
<script src="assets/libs/flatpickr/dist/flatpickr.min.js"></script>
<script src="assets/libs/highlightjs/highlight.pack.min.js"></script>
<script src="assets/libs/jquery-mask-plugin/dist/jquery.mask.min.js"></script>
<script src="assets/libs/quill/dist/quill.min.js"></script>
<script src="assets/libs/select2/dist/js/select2.min.js"></script>
<script src="assets/libs/chart.js/Chart.extension.min.js"></script>
<script src="assets/js/theme.min.js"></script>

</html>

<script>
    var coin_name = 0;

    ck_cookie();

    function ck_cookie() {
        var data = {
            result: 't_ck_cookie'
        }

        $.ajax({
            type: 'POST',
            url: './send_db.php',
            dataType: 'text',
            data: data,
            success: function(data) {
                var json_data = JSON.parse(data);
                if(json_data.code == 1){
                    coin_name = json_data.coin_name;
                    start();
                }else{
                    alert("잘못된 접근입니다.");
                    location.href = "./login.html";
                }
            },
            error: function(err) {
                alert('error: ' + JSON.stringify(err));
            }
        });
    }

    function start(){
        var data = {
            result: 't_start',
            coin_name: coin_name
        }

        $.ajax({
            type: 'POST',
            url: './send_db.php',
            dataType: 'text',
            data: data,
            success: function(data){
                var json_data = JSON.parse(data);
                if(json_data.code == 1){
                    var html = '';
                    html += '<tr>';
                    html += '   <td style="text-align: center;">'+json_data.coin_name+'</td>';
                    html += '   <td style="text-align: center;">'+json_data.convert_price+'</td>';
                    html += '   <td style="text-align: center;">'+json_data.cny_price+'</td>';
                    html += '   <td style="text-align: center;">'+json_data.usd_price+'</td>';
                    html += '   <td style="text-align: center;">'+json_data.krw_price+'</td>';
                    html += '   <td style="text-align: center;">'+json_data.payCoinNum+'</td>';
                    html += '   <td style="text-align: center;">'+json_data.payConvertNum+'</td>';
                    html += '   <td style="text-align: center;">'+json_data.receiveCoinNum+'</td>';
                    html += '   <td style="text-align: center;">'+json_data.receiveConvertNum+'</td>';
                    html += '</tr>';
                    $("#t_list").html(html);
                }else{
                    alert("서버 에러 잠시후 다시 시도하세요.");
                }
            },
            error: function(err) {
                alert('error: ' + JSON.stringify(err));
            }
        });
    }

    function logout(){
        var data = {
            result: 't_logout'
        }

        $.ajax({
            type: 'POST',
            url: './send_db.php',
            dataType: 'text',
            data: data,
            success: function(data){
                location.href="./login.html";
            },
            error: function(err){
                alert('error: ' + JSON.stringify(err));
            }
        });
    }
</script>